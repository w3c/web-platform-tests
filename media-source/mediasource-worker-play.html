<!DOCTYPE html>
<!-- Copyright Â© 2019 Chromium authors and World Wide Web Consortium, (Massachusetts Institute of Technology, ERCIM, Keio University, Beihang). -->
<html>
    <head>
        <title>Simple MediaSource-in-Worker playback test case.</title>
        <script src="/resources/testharness.js"></script>
        <script src="/resources/testharnessreport.js"></script>
    </head>
    <body>
        <script>

          async_test(function(test) {
            let video = document.createElement('video');
            document.body.appendChild(video);
            video.onerror = test.unreached_func("video element error");
            video.onended = test.step_func_done();

            let worker = new Worker("mediasource-worker-util.js");
            worker.onerror = test.unreached_func("worker error");
            worker.onmessage = test.step_func(function(evt) {
              if (evt.data.substr(0,6) == "Error:") {
                assert_unreached("Worker error: " + evt.data);
              } else {
                video.src = evt.data;  // Should be a MediaSource ObjectURL.
                video.play();
              }
            });
          }, "MediaSource-in-Workers: Test worker MediaSource construction, attachment, buffering and basic playback");

        </script>
    </body>
</html>
