<!DOCTYPE html>
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<script src="/preload/resources/preload_helper.js"></script>
<body>
<script>
promise_test(async t => {
    await new Promise(async (resolve, reject) => {
        if (!isPreloadAndRTSupported()) {
            reject("Unsupported APIs");
        }
        await untilResourceDownloaded("resources/square.png?link-header-preload");
        await untilResourceDownloaded("resources/dummy.js?link-header-preload");
        await untilResourceDownloaded("resources/dummy.css?link-header-preload");
        verifyNumberOfDownloads("resources/square.png?link-header-preload", 1);
        verifyNumberOfDownloads("resources/dummy.js?link-header-preload", 1);
        verifyNumberOfDownloads("resources/dummy.css?link-header-preload", 1);
        resolve();
    });
}, 'Makes sure that Link headers preload resources');
</script>
</body>
