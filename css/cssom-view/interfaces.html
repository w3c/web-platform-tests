<!doctype html>
<meta charset=utf-8>
<!-- WARNING: These tests are preliminary and probably partly incorrect.  -->
<title>CSSOM View automated IDL tests</title>
<link rel="author" title="Ms2ger" href="mailto:Ms2ger@gmail.com">
<link rel="help" href="https://drafts.csswg.org/cssom-view-1/#idl-index">
<script src=/resources/testharness.js></script>
<script src=/resources/testharnessreport.js></script>
<script src=/resources/WebIDLParser.js></script>
<script src=/resources/idlharness.js></script>

<input id="caretPositionInput" style="position: absolute; top: 0; left: 0; border: 0;">

<h1>CSSOM View IDL tests</h1>
<div id=log></div>

<script>
'use strict';

promise_test(async t => {
  await new Promise(resolve => { addEventListener('load', resolve); });
  const srcs = ['cssom-view', 'html', 'dom', 'uievents', 'cssom'];
  const [idl, html, dom, uievents, cssom] = await Promise.all(
    srcs.map(i => fetch(`/interfaces/${i}.idl`).then(r => r.text())));

  var idlArray = new IdlArray();
  idlArray.add_idls(idl);
  idlArray.add_dependency_idls(cssom);
  idlArray.add_dependency_idls(html);
  idlArray.add_dependency_idls(dom);
  idlArray.add_dependency_idls(uievents);

  idlArray.add_objects({
    Window: ['window'],
    MediaQueryList: ['matchMedia("all")'],
    MediaQueryListEvent: ['new MediaQueryListEvent("change")'],
    Screen: ['screen'],
    Document: ['document'],
    CaretPosition: ['document.caretPositionFromPoint(5, 5)'],
    Element: ['document.createElementNS("x", "y")'],
    HTMLElement: ['document.createElement("div")'],
    HTMLImageElement: ['document.createElement("img")'],
    Range: ['new Range()'],
    // MouseEvent: ['new MouseEvent("foo")'],
    Text: ['document.createTextNode("x")'],
    // CSSPseudoElement: [],
  });
  idlArray.test();
}, "Test driver");

</script>
