var SPEC_JSON = {"subresource_path": {"img-tag": "/referrer-policy/generic/subresource/image.py", "fetch-request": "/referrer-policy/generic/subresource/xhr.py", "a-tag": "/referrer-policy/generic/subresource/document.py", "area-tag": "/referrer-policy/generic/subresource/document.py", "iframe-tag": "/referrer-policy/generic/subresource/document.py", "xhr-request": "/referrer-policy/generic/subresource/xhr.py", "worker-request": "/referrer-policy/generic/subresource/worker.py", "script-tag": "/referrer-policy/generic/subresource/script.py"}, "test_expansion_schema": {"origin": ["same-origin", "cross-origin"], "subresource": ["iframe-tag", "img-tag", "script-tag", "a-tag", "area-tag", "xhr-request", "worker-request", "fetch-request"], "target_protocol": ["http", "https"], "delivery_method": ["http-csp", "meta-referrer", "meta-csp", "attr-referrer", "rel-noreferrer"], "referrer_url": ["omitted", "origin", "stripped-referrer"], "source_protocol": ["http", "https"]}, "specification": [{"specification_url": "https://w3c.github.io/webappsec/specs/referrer-policy/#referrer-policy-states", "referrer_policy": null, "title": "Referrer Policy is not explicitly defined", "test_expansion": [{"origin": "*", "subresource": "*", "target_protocol": "*", "delivery_method": ["http-csp", "meta-referrer", "meta-csp", "attr-referrer"], "referrer_url": "stripped-referrer", "source_protocol": "*", "name": "generic"}], "name": "unset-referrer-policy", "description": "Check that sub-resource gets the referrer URL when no explicit Referrer Policy is set."}, {"specification_url": "https://w3c.github.io/webappsec/specs/referrer-policy/#referrer-policy-state-no-referrer", "referrer_policy": "no-referrer", "title": "Referrer Policy is set to 'no-referrer'", "test_expansion": [{"origin": "*", "subresource": "*", "target_protocol": "*", "delivery_method": "*", "referrer_url": "omitted", "source_protocol": "*", "name": "generic"}], "name": "no-referrer", "description": "Check that sub-resource never gets the referrer URL."}, {"specification_url": "https://w3c.github.io/webappsec/specs/referrer-policy/#referrer-policy-state-no-referrer-when-downgrade", "referrer_policy": "no-referrer-when-downgrade", "title": "Referrer Policy is set to 'no-referrer-when-downgrade'", "test_expansion": [{"origin": "*", "subresource": "*", "target_protocol": "http", "delivery_method": ["http-csp", "meta-referrer", "meta-csp", "attr-referrer"], "referrer_url": "stripped-referrer", "source_protocol": "http", "name": "insecure-protocol"}, {"origin": "*", "subresource": "*", "target_protocol": "https", "delivery_method": ["http-csp", "meta-referrer", "meta-csp", "attr-referrer"], "referrer_url": "stripped-referrer", "source_protocol": "http", "name": "upgrade-protocol"}, {"origin": "*", "subresource": "*", "target_protocol": "http", "delivery_method": ["http-csp", "meta-referrer", "meta-csp", "attr-referrer"], "referrer_url": "origin", "source_protocol": "https", "name": "downgrade-protocol"}, {"origin": "*", "subresource": "*", "target_protocol": "https", "delivery_method": ["http-csp", "meta-referrer", "meta-csp", "attr-referrer"], "referrer_url": "stripped-referrer", "source_protocol": "https", "name": "secure-protocol"}], "name": "no-referrer-when-downgrade", "description": "Check that non a priori insecure subresource gets the full Referrer URL. A priori insecure subresource gets no referrer information."}, {"specification_url": "https://w3c.github.io/webappsec/specs/referrer-policy/#referrer-policy-state-origin", "referrer_policy": "origin", "title": "Referrer Policy is set to 'origin-only'", "test_expansion": [{"origin": "*", "subresource": "*", "target_protocol": "*", "delivery_method": ["http-csp", "meta-referrer", "meta-csp", "attr-referrer"], "referrer_url": "origin", "source_protocol": "*", "name": "generic"}], "name": "origin-only", "description": "Check that all subresources in all casses get only the origin portion of the referrer URL."}, {"specification_url": "https://w3c.github.io/webappsec/specs/referrer-policy/#referrer-policy-state-origin-when-cross-origin", "referrer_policy": "origin-when-crossorigin", "title": "Referrer Policy is set to 'origin-when-crossorigin'", "test_expansion": [{"origin": "same-origin", "subresource": "*", "target_protocol": "http", "delivery_method": ["http-csp", "meta-referrer", "meta-csp", "attr-referrer"], "referrer_url": "stripped-referrer", "source_protocol": "http", "name": "same-origin-insecure"}, {"origin": "same-origin", "subresource": "*", "target_protocol": "https", "delivery_method": ["http-csp", "meta-referrer", "meta-csp", "attr-referrer"], "referrer_url": "stripped-referrer", "source_protocol": "https", "name": "same-origin-secure"}, {"origin": "same-origin", "subresource": "*", "target_protocol": "https", "delivery_method": ["http-csp", "meta-referrer", "meta-csp", "attr-referrer"], "referrer_url": "origin", "source_protocol": "http", "name": "same-origin-upgrade"}, {"origin": "same-origin", "subresource": "*", "target_protocol": "https", "delivery_method": ["http-csp", "meta-referrer", "meta-csp", "attr-referrer"], "referrer_url": "origin", "source_protocol": "http", "name": "same-origin-downgrade"}, {"origin": "cross-origin", "subresource": "*", "target_protocol": "*", "delivery_method": ["http-csp", "meta-referrer", "meta-csp", "attr-referrer"], "referrer_url": "origin", "source_protocol": "*", "name": "cross-origin-generic"}], "name": "origin-when-cross-origin", "description": "Check that cross-origin subresources get the origin portion of the referrer URL and same-origin get the stripped referrer URL."}, {"specification_url": "https://w3c.github.io/webappsec/specs/referrer-policy/#referrer-policy-state-unsafe-url", "referrer_policy": "unsafe-url", "title": "Referrer Policy is set to 'unsafe-url'", "test_expansion": [{"origin": "*", "subresource": "*", "target_protocol": "*", "delivery_method": ["http-csp", "meta-referrer", "meta-csp", "attr-referrer"], "referrer_url": "stripped-referrer", "source_protocol": "*", "name": "generic"}], "name": "unsafe-url", "description": "Check that all sub-resources get the stripped referrer URL."}], "referrer_policy_schema": [null, "no-referrer", "no-referrer-when-downgrade", "origin", "origin-when-crossorigin", "unsafe-url"], "excluded_tests": [{"origin": "cross-origin", "subresource": "worker-request", "target_protocol": "*", "delivery_method": "*", "referrer_url": "*", "source_protocol": "*", "name": "cross-origin-workers"}, {"origin": "*", "subresource": "worker-request", "target_protocol": "https", "delivery_method": "*", "referrer_url": "*", "source_protocol": "http", "name": "upgraded-protocol-workers"}, {"origin": "*", "subresource": "*", "target_protocol": "http", "delivery_method": "*", "referrer_url": "*", "source_protocol": "https", "name": "mixed-content-insecure-subresources"}, {"origin": "*", "subresource": ["iframe-tag", "img-tag", "script-tag", "xhr-request", "worker-request", "fetch-request", "area-tag"], "target_protocol": "*", "delivery_method": ["attr-referrer", "rel-noreferrer"], "referrer_url": "*", "source_protocol": "*", "name": "elements-not-supporting-attr-referrer-or-rel-noreferrer"}, {"origin": "*", "subresource": "area-tag", "target_protocol": "*", "delivery_method": "*", "referrer_url": "*", "source_protocol": "*", "name": "area-tag"}, {"origin": "*", "subresource": "*", "target_protocol": "*", "delivery_method": "*", "referrer_url": "*", "source_protocol": "https", "name": "source-https-unsupported-by-web-platform-tests-built-in-runner"}]};
