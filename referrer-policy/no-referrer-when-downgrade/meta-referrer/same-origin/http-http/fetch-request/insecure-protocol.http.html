<!DOCTYPE html>
<!-- DO NOT EDIT! Generated by referrer-policy/generic/tools/generate.py using referrer-policy/generic/template/test.html.template. -->
<!-- TODO(kristijanburnik): Create a template for automated tests:
http://testthewebforward.org/docs/test-templates.html#script-test-with-metadata
-->
<html>
  <head>
    <title>Referrer-Policy: Referrer Policy is set to 'no-referrer-when-downgrade'</title>
    <meta name="description" content="Check that non a priori insecure subresource gets the full Referrer URL. A priori insecure subresource gets no referrer information.">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <script src="/resources/testharness.js"></script>
    <script src="/resources/testharnessreport.js"></script>
    <!-- Common global functions for referrer-policy tests. -->
    <script src="/referrer-policy/generic/common.js"></script>
    <!-- The original specification JSON for validating the scenario. -->
    <script src="/referrer-policy/spec_json.js"></script>
    <!-- Simple wrapper API for all referrer-policy test cases. -->
    <script src="/referrer-policy/generic/referrer-policy-test-case.js?pipe=sub"></script>
  </head>
  <body>
    <h1>Referrer Policy is set to 'no-referrer-when-downgrade'</h1>
    <h2>Check that non a priori insecure subresource gets the full Referrer URL. A priori insecure subresource gets no referrer information.</h2>

    <p id="description">The referrer URL is stripped-referrer when a document
      served over http requires an http
      sub-resource via fetch-request using the meta-referrer delivery
      method and when the target request is same-origin.</p>

    <p>See <a href="https://w3c.github.io/webappsec/specs/referrer-policy/#referrer-policy-state-no-referrer-when-downgrade" target="_blank">specification</a>
       details for this test.</p>

    <h3>Scenario outline</h3>
    <table>
      <tbody>
        <tr>
          <th>Delivery method</th>
          <td>meta-referrer</td></tr>
        <tr>
          <th>Origin transition</th>
          <td>same-origin</td></tr>
        <tr>
          <th>Protocol transition</th>
          <td>from http to http</td></tr>
        <tr>
          <th>Subresource type</th>
          <td>fetch-request</td></tr>
        <tr>
          <td colspan="2"><hr></td>
        </tr>
        <tr>
          <th>Expected result</th>
          <td>Referrer URL should be <strong>stripped-referrer</strong></td>
        </tr>
      <tbody>
    </table>

    <script>
      var scenario = {
        "referrer_policy": "no-referrer-when-downgrade",
        "delivery_method": "meta-referrer",
        "origin": "same-origin",
        "source_protocol": "http",
        "target_protocol": "http",
        "subresource": "fetch-request",
        "referrer_url": "stripped-referrer"
      };
      var description = document.getElementById("description").innerHTML;
      ReferrerPolicyTestCase(scenario, description).start();
    </script>

    <div id="log"></div>
  </body>
</html>
