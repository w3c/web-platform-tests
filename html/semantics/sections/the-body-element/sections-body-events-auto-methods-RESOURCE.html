<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Body Element</title>
	<link rel="author" title="dzenana" href="mailto:dzenana.trenutak@gmail.com">
	<link rel="help" href="http://www.w3.org/html/wg/drafts/html/CR/single-page.html#the-body-element">
</head>
<body>

	<h1 id="first_hash">Purpose of form</h1>
	<p>This new window is here to test that body element's automatable event handlers truly respond to given events.</p>
	<p>Please be patient!</p>
	<p>There is a long (10 second) interval between the firing of these events and the return to the testing page.</p>
	<p>But you will get there eventually.</p>
	<h1 id="second_hash">List of Events</h1>
	<p>We are going to test:</p>
	<ul>
		<li>load</li>
		<li>pageshow</li>
		<li>blur</li>
		<li>focus</li>
		<li>scroll</li>
		<li>popstate</li>
		<li>hashchange</li>
		<li>message</li>
		<li>storage</li>
		<li>error</li>
		<li>beforeunload</li>
		<li>pagehide</li>
		<li>unload</li>
	</ul>
	<a id="first_anchor" href="#first_hash">Purpose</a>
	<a id="second_anchor" href="#second_hash">Events</a>
	<script>
		function runEvents() {
			// LOAD event occurred, that is how this function is called
				// (no code needed)

			// PAGESHOW event should also occur after load event for this new document

			// The BLUR and FOCUS events happen thanks to this new window
			// pulling the action away from the main test page for this interval

			// SCROLL in window
			window.scrollBy(2,2);
			window.scrollBy(-2,-2);;			

			// change hashtags -- this should generate both POPSTATE and HASHCHANGE events
			var myAnchor = document.getElementById("second_anchor");
			myAnchor.click();
			myAnchor = document.getElementById("first_anchor");
			myAnchor.click();			

			// send some MESSAGEs
			window.postMessage("message for you", "*");
			window.opener.postMessage("message for you", "*");

			// use STORAGE
			localStorage.clear();
			localStorage["key1"] = "value1";
			localStorage["key2"] = "value2";
			localStorage.clear();

			// cause an ERROR
			var myError = document.createEvent("Event");
                	myError.initEvent("error", true, false);
                	document.body.dispatchEvent(myError);

			// closing this window after this function returns should generate 
			// BEFOREUNLOAD, PAGEHIDE, and UNLOAD events
		}

		// create IDL event handlers 
		document.body.onscroll = function() { window.opener.myReaction.push("scroll-IDL"); };
		document.body.onblur = function() { window.opener.myReaction.push("blur-IDL"); };
		document.body.onfocus = function() { window.opener.myReaction.push("focus-IDL"); };
		document.body.onhashchange = function() { window.opener.myReaction.push("hashchange-IDL"); };
		document.body.onpagehide = function() { window.opener.myReaction.push("pagehide-IDL"); };
		document.body.onpageshow = function() { window.opener.myReaction.push("pageshow-IDL"); };
		document.body.onmessage = function() { window.opener.myReaction.push("message-IDL"); };
		document.body.onstorage = function() { window.opener.myReaction.push("storage-IDL"); };
		document.body.onerror = function() { window.opener.myReaction.push("error-IDL"); };
		document.body.onpopstate = function() { window.opener.myReaction.push("popstate-IDL"); };
		document.body.onbeforeunload = function() { window.opener.myReaction.push("beforeunload-IDL"); };
		document.body.onunload = function() { window.opener.myReaction.push("unload-IDL"); };

		// run events
		window.onload = function() {
			runEvents();
			// wait, then close window
			setTimeout(window.close, 10000);
		}
		
	</script>

<body>




