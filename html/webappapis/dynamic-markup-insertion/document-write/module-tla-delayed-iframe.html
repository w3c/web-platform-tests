<!doctype html>
<meta charset=utf-8>
<script type=module>
let delay = new Promise(
    resolve => window.parent.document.test.step_timeout(resolve, 0));

delay.then(() => {
  document.write("PASS");
  document.close();
  window.parent.document.dispatchEvent(new CustomEvent("testTimeoutDone"));
});

await delay;
</script>
FAIL
